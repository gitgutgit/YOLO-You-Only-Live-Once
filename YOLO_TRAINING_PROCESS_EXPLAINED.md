# ğŸ¯ YOLO í•™ìŠµ ê³¼ì • ì™„ì „ ë¶„ì„

## ğŸ“ 1. YOLO í•™ìŠµì„ ì–´ë””ì„œ ì •í™•í•˜ê²Œ í•˜ëŠ”ê°€?

### ì‹¤í–‰ ìœ„ì¹˜ì™€ ëª…ë ¹ì–´

**ì‹¤ì œ ì‹¤í–‰ ìœ„ì¹˜**: í„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì‹¤í–‰

```bash
cd web_app
yolo detect train data=game_dataset/data.yaml model=yolov8n.pt epochs=50 imgsz=640
```

**ë˜ëŠ”** (ìƒëŒ€ ê²½ë¡œ ì‚¬ìš©)

```bash
cd web_app
yolo detect train model=yolov8n.pt data=./data.yaml epochs=50 imgsz=640
```

### í•µì‹¬ í¬ì¸íŠ¸

- âœ… **í„°ë¯¸ë„ ëª…ë ¹ì–´ë¡œ ì‹¤í–‰**: Python ìŠ¤í¬ë¦½íŠ¸ê°€ ì•„ë‹ˆë¼ `yolo` CLI ëª…ë ¹ì–´ ì‚¬ìš©
- âœ… **Ultrralytics YOLOv8 íŒ¨í‚¤ì§€**: `pip install ultralytics`ë¡œ ì„¤ì¹˜ëœ ëª…ë ¹ì–´
- âœ… **ì‘ì—… ë””ë ‰í† ë¦¬**: `web_app/` í´ë”ì—ì„œ ì‹¤í–‰ (data.yamlì˜ ìƒëŒ€ ê²½ë¡œ ì°¸ì¡°)
- âœ… **ê²°ê³¼ ì €ì¥ ìœ„ì¹˜**: í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `runs/detect/train2/` í´ë”ì— ìë™ ìƒì„±

---

## âœ… 2. yolo ëª…ë ¹ì–´ë¡œ best.ptë¥¼ ìƒì„±í•œ ê±´ê°€?

**ë‹µ: ë„¤, ë§ìŠµë‹ˆë‹¤!**

### ìƒì„± ê³¼ì •

1. **ëª…ë ¹ì–´ ì‹¤í–‰**

   ```bash
   yolo detect train data=game_dataset/data.yaml model=yolov8n.pt epochs=50
   ```

2. **YOLOê°€ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ë“¤**:

   - `data.yaml` íŒŒì¼ ì½ê¸° â†’ ë°ì´í„°ì…‹ ê²½ë¡œ í™•ì¸
   - `images/train/` í´ë”ì˜ ì´ë¯¸ì§€ íŒŒì¼ ëª©ë¡ ë¡œë“œ
   - ê° ì´ë¯¸ì§€ì— ëŒ€ì‘í•˜ëŠ” `labels/train/*.txt` íŒŒì¼ ì°¾ê¸°
   - ì‚¬ì „ í›ˆë ¨ ëª¨ë¸ `yolov8n.pt` ë‹¤ìš´ë¡œë“œ (ì—†ëŠ” ê²½ìš°)
   - 50 ì—í¬í¬ ë™ì•ˆ í•™ìŠµ ì‹œì‘

3. **í•™ìŠµ ì¤‘ ìƒì„±ë˜ëŠ” íŒŒì¼ë“¤**:

   ```
   runs/detect/train2/
   â”œâ”€â”€ weights/
   â”‚   â”œâ”€â”€ best.pt      â† ìµœê³  ì„±ëŠ¥ ëª¨ë¸ (ê²€ì¦ ì„±ëŠ¥ ê¸°ì¤€)
   â”‚   â””â”€â”€ last.pt      â† ë§ˆì§€ë§‰ ì—í¬í¬ ëª¨ë¸
   â”œâ”€â”€ args.yaml        â† í›ˆë ¨ ì„¤ì • ì €ì¥
   â”œâ”€â”€ results.csv      â† ê° ì—í¬í¬ë³„ ì„±ëŠ¥ ì§€í‘œ
   â”œâ”€â”€ train_batch0.jpg â† í•™ìŠµ ë°°ì¹˜ ì‹œê°í™”
   â”œâ”€â”€ val_batch0_labels.jpg â† ê²€ì¦ ë°ì´í„° ë¼ë²¨
   â”œâ”€â”€ val_batch0_pred.jpg   â† ê²€ì¦ ë°ì´í„° ì˜ˆì¸¡ ê²°ê³¼
   â””â”€â”€ ... (ê¸°íƒ€ ê·¸ë˜í”„, í˜¼ë™ í–‰ë ¬ ë“±)
   ```

4. **best.pt ìƒì„± ê¸°ì¤€**:
   - ë§¤ ì—í¬í¬ë§ˆë‹¤ ê²€ì¦ ë°ì´í„°ë¡œ ì„±ëŠ¥ í‰ê°€
   - **mAP@50** (mean Average Precision) ê°’ì´ ê°€ì¥ ë†’ì€ ì—í¬í¬ì˜ ëª¨ë¸ ì €ì¥
   - ìµœì¢… ê²°ê³¼: `runs/detect/train2/weights/best.pt`

---

## ğŸ”„ 3. ë¼ë²¨ë§ ê²°ê³¼ë¥¼ YOLOì—ì„œ ì–´ë–»ê²Œ ì²˜ë¦¬í•˜ëŠ”ê°€? (ì¤‘ê°„ ê³¼ì •)

### 3.1 ë°ì´í„° íë¦„ ì „ì²´ ê³¼ì •

```
ê²Œì„ í”Œë ˆì´
    â†“
yolo_exporter.pyê°€ ë¼ë²¨ ìƒì„±
    â†“
game_dataset/
â”œâ”€â”€ images/train/*.jpg  (1,276ê°œ)
â””â”€â”€ labels/train/*.txt  (1,276ê°œ)
    â†“
data.yaml ì½ê¸°
    â†“
YOLO í•™ìŠµ ì‹œì‘
```

### 3.2 ë¼ë²¨ íŒŒì¼ êµ¬ì¡° ì˜ˆì‹œ

**ì‹¤ì œ ë¼ë²¨ íŒŒì¼** (`game_20251122_3r5hYvcN_00690.txt`):

```
0 0.505208 0.965278 0.052083 0.069444    â† í”Œë ˆì´ì–´ (Class 0)
2 0.968750 0.575000 0.031250 0.041667    â† ë³„ (Class 2)
2 0.744792 0.558333 0.031250 0.041667    â† ë³„ (Class 2)
1 0.207292 0.791667 0.052083 0.069444    â† ìš´ì„ (Class 1)
1 0.640625 0.631944 0.052083 0.069444    â† ìš´ì„ (Class 1)
... (ì´ 11ê°œ ê°ì²´)
3 0.833333 0.916667 0.333333 0.166667    â† ìš©ì•” ê²½ê³  (Class 3)
```

**ê° ì¤„ì˜ ì˜ë¯¸**:

```
class_id  x_center  y_center  width  height
   â†“         â†“         â†“        â†“      â†“
   ì •ìˆ˜    ì •ê·œí™”   ì •ê·œí™”   ì •ê·œí™”  ì •ê·œí™”
          (0~1)    (0~1)   (0~1)  (0~1)
```

### 3.3 YOLOê°€ ë¼ë²¨ì„ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •

#### Step 1: data.yaml ì½ê¸°

```yaml
path: /Users/jeewonkim/.../web_app/game_dataset
train: images/train
val: images/val
nc: 5
names: ["player", "meteor", "star", "caution_lava", "exist_lava"]
```

YOLOëŠ” ì´ë¥¼ ì½ê³ :

- ì´ë¯¸ì§€ í´ë”: `{path}/images/train/`
- ë¼ë²¨ í´ë”: `{path}/labels/train/` (ìë™ìœ¼ë¡œ ë§¤ì¹­)
- í´ë˜ìŠ¤ ìˆ˜: 5ê°œ
- í´ë˜ìŠ¤ ì´ë¦„ ë§¤í•‘ í™•ì¸

#### Step 2: ì´ë¯¸ì§€-ë¼ë²¨ ìŒ ë§¤ì¹­

YOLOëŠ” íŒŒì¼ ì´ë¦„ìœ¼ë¡œ ìë™ ë§¤ì¹­:

- ì´ë¯¸ì§€: `game_20251122_3r5hYvcN_00690.jpg`
- ë¼ë²¨: `game_20251122_3r5hYvcN_00690.txt`

ê°™ì€ íŒŒì¼ëª…(í™•ì¥ì ì œì™¸)ì„ ê°€ì§„ íŒŒì¼ë¼ë¦¬ ìë™ìœ¼ë¡œ ì—°ê²°!

#### Step 3: ë°°ì¹˜ë¡œ ë¬¶ì–´ì„œ í•™ìŠµ

ê° ë°°ì¹˜(ê¸°ë³¸ 16ê°œ)ë§ˆë‹¤:

```
ë°°ì¹˜ 0:
- game_xxx_00010.jpg + game_xxx_00010.txt
- game_xxx_00020.jpg + game_xxx_00020.txt
- ...
- game_xxx_00160.jpg + game_xxx_00160.txt
```

#### Step 4: ë¼ë²¨ íŒŒì¼ íŒŒì‹±

ê° `.txt` íŒŒì¼ì„ ì½ì–´ì„œ:

```python
# YOLO ë‚´ë¶€ ë¡œì§ (ì˜ì‚¬ì½”ë“œ)
for line in label_file:
    class_id, x_center, y_center, width, height = line.split()

    # ì •ê·œí™” ì¢Œí‘œ â†’ í”½ì…€ ì¢Œí‘œ ë³€í™˜
    img_width, img_height = image.size
    x_pixel = float(x_center) * img_width
    y_pixel = float(y_center) * img_height
    w_pixel = float(width) * img_width
    h_pixel = float(height) * img_height

    # ë°”ìš´ë”© ë°•ìŠ¤ ìƒì„±
    bbox = [x_pixel, y_pixel, w_pixel, h_pixel]

    # Ground Truth ê°ì²´ ì €ì¥
    gt_objects.append({
        'class': int(class_id),
        'bbox': bbox
    })
```

#### Step 5: ë°ì´í„° ì¦ê°• ì ìš©

ê° ë°°ì¹˜ë§ˆë‹¤ ìë™ìœ¼ë¡œ ì¦ê°•:

- ì¢Œìš° ë°˜ì „ (flip_lr: 0.5 í™•ë¥ )
- Mosaic (4ê°œ ì´ë¯¸ì§€ í•©ì„±)
- HSV ë³€í™˜ (ë°ê¸°, ì±„ë„ ì¡°ì •)
- ... ë“±ë“±

**ì¤‘ìš”**: ì¦ê°• ì‹œ ë¼ë²¨ë„ í•¨ê»˜ ë³€í™˜!

- ì´ë¯¸ì§€ë¥¼ ì¢Œìš° ë°˜ì „í•˜ë©´ â†’ x_centerë„ `1.0 - x_center`ë¡œ ë³€í™˜
- ì´ë¯¸ì§€ í¬ê¸° ì¡°ì •í•˜ë©´ â†’ ì¢Œí‘œë„ ë¹„ë¡€í•´ì„œ ì¡°ì •

#### Step 6: ëª¨ë¸ì— ì…ë ¥

```
ë°°ì¹˜ ì´ë¯¸ì§€ (16ê°œ, 640x640x3)
    â†“
YOLOv8 ëª¨ë¸
    â†“
ì˜ˆì¸¡ ê²°ê³¼ (ë°”ìš´ë”© ë°•ìŠ¤ + í´ë˜ìŠ¤ í™•ë¥ )
    â†“
Ground Truthì™€ ë¹„êµ
    â†“
Loss ê³„ì‚° (box_loss, cls_loss, dfl_loss)
    â†“
ì—­ì „íŒŒ (Backpropagation)
    â†“
ê°€ì¤‘ì¹˜ ì—…ë°ì´íŠ¸
```

### 3.4 ì¤‘ê°„ ê³¼ì • í™•ì¸í•˜ëŠ” ë°©ë²•

#### ë°©ë²• 1: í•™ìŠµ ë°°ì¹˜ ì´ë¯¸ì§€ í™•ì¸

**íŒŒì¼ ìœ„ì¹˜**: `runs/detect/train2/train_batch0.jpg`

ì´ ì´ë¯¸ì§€ë¥¼ ë³´ë©´:

- 16ê°œì˜ ê²Œì„ í™”ë©´ì´ ê·¸ë¦¬ë“œë¡œ í‘œì‹œ
- ê° ê°ì²´ì— ë°”ìš´ë”© ë°•ìŠ¤ì™€ í´ë˜ìŠ¤ ë¼ë²¨ í‘œì‹œ
- ì˜ˆ: "player", "meteor", "star" ë“±

**ì˜ë¯¸**:

- YOLOê°€ ì‹¤ì œë¡œ "ë³´ëŠ”" ì…ë ¥ ë°ì´í„°
- ë¼ë²¨ë§ì´ ì œëŒ€ë¡œ ë˜ì–´ìˆëŠ”ì§€ í™•ì¸ ê°€ëŠ¥

#### ë°©ë²• 2: ê²€ì¦ ê²°ê³¼ í™•ì¸

**ê²€ì¦ ë¼ë²¨ (Ground Truth)**:

- `runs/detect/train2/val_batch0_labels.jpg`
- ì‹¤ì œ ì •ë‹µ ë¼ë²¨ í‘œì‹œ

**ê²€ì¦ ì˜ˆì¸¡ (Model Prediction)**:

- `runs/detect/train2/val_batch0_pred.jpg`
- ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ê²°ê³¼ í‘œì‹œ

**ë¹„êµí•˜ë©´**:

- ì´ˆê¸° ì—í¬í¬: ì˜ˆì¸¡ì´ ë§ì´ í‹€ë¦¼
- í›„ê¸° ì—í¬í¬: ì˜ˆì¸¡ì´ ì •ë‹µì— ê°€ê¹Œì›Œì§

#### ë°©ë²• 3: ê²°ê³¼ CSV í™•ì¸

**íŒŒì¼**: `runs/detect/train2/results.csv`

```csv
epoch,metrics/precision(B),metrics/recall(B),metrics/mAP50(B),...
1,0.00357,0.40053,0.10643,...
2,0.00868,0.43118,0.30398,...
...
50,0.96502,0.98222,0.98824,...
```

**ì˜ë¯¸**:

- **precision**: ëª¨ë¸ì´ ì°¾ì€ ê²ƒ ì¤‘ ì •í™•í•œ ë¹„ìœ¨
- **recall**: ì‹¤ì œ ê°ì²´ ì¤‘ ëª¨ë¸ì´ ì°¾ì€ ë¹„ìœ¨
- **mAP@50**: í‰ê·  ì •í™•ë„ (IoU=0.5 ê¸°ì¤€)

#### ë°©ë²• 4: í˜¼ë™ í–‰ë ¬ í™•ì¸

**íŒŒì¼**: `runs/detect/train2/confusion_matrix.png`

**ì˜ë¯¸**:

- ê° í´ë˜ìŠ¤ë³„ë¡œ ì–¼ë§ˆë‚˜ ì˜ ë¶„ë¥˜í–ˆëŠ”ì§€
- ì˜ˆ: playerë¥¼ meteorë¡œ ì˜ëª» ë¶„ë¥˜í•œ íšŸìˆ˜ ë“±

---

## ğŸ“Š ì „ì²´ í”„ë¡œì„¸ìŠ¤ ìš”ì•½

### 1ë‹¨ê³„: ë°ì´í„° ì¤€ë¹„

```
ê²Œì„ í”Œë ˆì´ â†’ yolo_exporter.py â†’
game_dataset/images/train/*.jpg
game_dataset/labels/train/*.txt
```

### 2ë‹¨ê³„: YOLO í•™ìŠµ ì‹œì‘

```bash
yolo detect train data=game_dataset/data.yaml model=yolov8n.pt epochs=50
```

### 3ë‹¨ê³„: YOLO ë‚´ë¶€ ì²˜ë¦¬

1. `data.yaml` ì½ê¸° â†’ ê²½ë¡œ í™•ì¸
2. ì´ë¯¸ì§€-ë¼ë²¨ ìë™ ë§¤ì¹­
3. ë°°ì¹˜ ìƒì„± (16ê°œì”©)
4. ë°ì´í„° ì¦ê°•
5. ëª¨ë¸ í•™ìŠµ (50 ì—í¬í¬)
6. ë§¤ ì—í¬í¬ë§ˆë‹¤ ê²€ì¦
7. `best.pt` ì €ì¥ (ìµœê³  ì„±ëŠ¥ ëª¨ë¸)

### 4ë‹¨ê³„: ê²°ê³¼ í™•ì¸

```
runs/detect/train2/
â”œâ”€â”€ weights/best.pt      â† ìµœì¢… ëª¨ë¸
â”œâ”€â”€ train_batch*.jpg     â† í•™ìŠµ ë°ì´í„° ì‹œê°í™”
â”œâ”€â”€ val_batch*.jpg       â† ê²€ì¦ ê²°ê³¼ ì‹œê°í™”
â”œâ”€â”€ results.csv          â† ì„±ëŠ¥ ì§€í‘œ
â””â”€â”€ ... (ê·¸ë˜í”„, í˜¼ë™ í–‰ë ¬ ë“±)
```

---

## ğŸ” ì‹¤ì „ ì˜ˆì œ: ì‹¤ì œ ë°ì´í„°ë¡œ í™•ì¸

### ë¼ë²¨ íŒŒì¼ ì˜ˆì‹œ ë¶„ì„

**íŒŒì¼**: `game_20251122_3r5hYvcN_00690.txt`

```
0 0.505208 0.965278 0.052083 0.069444
```

**í•´ì„**:

- Class 0 (player)
- ì¤‘ì‹¬ ì¢Œí‘œ: (0.505208, 0.965278)
  - x = 0.505208 Ã— 960 = 485 í”½ì…€
  - y = 0.965278 Ã— 720 = 695 í”½ì…€
- í¬ê¸°: 0.052083 Ã— 960 = 50 í”½ì…€ (ë„ˆë¹„)
  - 0.069444 Ã— 720 = 50 í”½ì…€ (ë†’ì´)

**ì¦‰, í”Œë ˆì´ì–´ê°€ í™”ë©´ í•˜ë‹¨ ì¤‘ì•™ì— ìœ„ì¹˜í•˜ê³  ìˆìŒ!**

### í•™ìŠµ ì¤‘ê°„ ê³¼ì • í™•ì¸ ë°©ë²•

1. **ì‹¤ì‹œê°„ í™•ì¸**: í„°ë¯¸ë„ì—ì„œ í•™ìŠµ ì§„í–‰ ìƒí™© ëª¨ë‹ˆí„°ë§
2. **ë°°ì¹˜ ì´ë¯¸ì§€**: `train_batch*.jpg` íŒŒì¼ë“¤ì„ ì—´ì–´ë³´ê¸°
3. **ê²°ê³¼ CSV**: `results.csv`ë¥¼ ì—‘ì…€/íŒŒì´ì¬ìœ¼ë¡œ ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
4. **ê²€ì¦ ê²°ê³¼**: `val_batch0_pred.jpg`ë¡œ ëª¨ë¸ ì„±ëŠ¥ í™•ì¸

---

## ğŸ’¡ í•µì‹¬ ì •ë¦¬

1. **ì–´ë””ì„œ í•™ìŠµ?**: í„°ë¯¸ë„ì—ì„œ `yolo detect train` ëª…ë ¹ì–´ ì‹¤í–‰
2. **best.pt ìƒì„±?**: ë„¤, YOLO ëª…ë ¹ì–´ê°€ ìë™ìœ¼ë¡œ ìƒì„±
3. **ë¼ë²¨ ì²˜ë¦¬ ê³¼ì •?**:

   - `data.yaml` ì½ê¸°
   - ì´ë¯¸ì§€-ë¼ë²¨ íŒŒì¼ëª… ë§¤ì¹­
   - ë°°ì¹˜ ìƒì„± ë° ì¦ê°•
   - ëª¨ë¸ í•™ìŠµ ë° ê²€ì¦
   - ìµœê³  ì„±ëŠ¥ ëª¨ë¸ ì €ì¥

4. **ì¤‘ê°„ ê³¼ì • í™•ì¸?**:
   - `train_batch*.jpg`: í•™ìŠµ ë°ì´í„° ì‹œê°í™”
   - `val_batch*.jpg`: ê²€ì¦ ê²°ê³¼ ì‹œê°í™”
   - `results.csv`: ì„±ëŠ¥ ì§€í‘œ ì¶”ì 
   - í„°ë¯¸ë„ ì¶œë ¥: ì‹¤ì‹œê°„ ì§„í–‰ ìƒí™©

---

**ì‘ì„±ì¼**: 2025-11-29
**ì°¸ê³  íŒŒì¼**:

- `runs/detect/train2/args.yaml`
- `runs/detect/train2/results.csv`
- `web_app/game_dataset/data.yaml`
